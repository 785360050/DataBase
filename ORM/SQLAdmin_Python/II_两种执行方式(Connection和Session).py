# ============================================================================================================
# Session和Connection都可以在创建engine连接后，操作数据库
# ============================================================================================================
# 		一、使用ORM会话操作数据库(简单易读，推荐使用)
# ============================================================================================================
from I_Engine连接数据库 import engine # 导入连接

# ============================================================================================================
print("简单查询")
# ============================================================================================================
from sqlalchemy.orm import Session
with Session(engine) as session:
    from sqlalchemy import select,text

    result = session.execute(text("select * from ORM.user_account;"))
    for row in result:
        print(f"Record : {row}")

# ============================================================================================================
# 		二、使用底层Connection直接操作数据库(不推荐，使用ORM了还追求底层，意义不大)
# ============================================================================================================
from sqlalchemy import text
with engine.connect() as connection:
    result = connection.execute(text("select * from ORM.user_account;"))


# ============================================================================================================
# 执行结果
# 可能是因为共享了同一个引擎，所以查询的记录是连续的，而不是同一个
# ============================================================================================================
# 简单查询
# Record: (1, 'spongebob', 'Spongebob Squarepants')
# Record: (2, 'sandy', 'Sandy Cheeks')
# ============================================================================================================
